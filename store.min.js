function avatar_load(){$("#avatar_loading").css("visibility","visible");var t=new FormData($("#avatar_upload_form")[0]);$.ajax({type:"POST",url:$("#avatar_upload_form").attr("action"),data:t,dataType:"json",success:function(t){$(".js-user-avatar").html(t.html)},complete:function(){$("#avatar_loading").css("visibility","hidden")},cache:!1,contentType:!1,processData:!1})}function myTrim(t){return t.replace(/^\s+|\s+$/gm,"")}function getFilter(){var t={},a=[],e=["price"];return"undefined"!=typeof noUiSlider&&(t.price=$.map(price_slider.noUiSlider.get(),function(t){return parseFloat(t).toFixed(0)})),$("#js-filter-brand, [id^=js-attr]").each(function(){var a=this.id.replace(/js-(?:filter|attr)-/gi,""),i=$(this),n=i.is("#js-filter-brand")?i:i.next(".js-attr-values");n.find(":checked").each(function(){(t[a]=t[a]||[]).push($(this).val())}),e.push(a)}),$.each(e,function(e,i){i in t&&a.push(i+"="+t[i].join("price"==i?"-":","))}),a.join(";")}var price_slider;$.fn.classFade=function(t,a){var e=this;return e.addClass(t),setTimeout(function(){e.removeClass(t)},a),e},$(document).ready(function(){$(".js-avatar-load input").change(avatar_load),$.fn.datepicker&&$(".date-picker").datepicker({endDate:"today",language:"ru",autoclose:!0}),$("body").on("click",".js-ajax-link",function(e){var t=$(this),sel=t.attr("data-result"),url=t.attr("data-url");if(t.data("link")){var linked=$("[data-linked="+t.data("link")+"]").filter(function(){return""!=$(this).data("value")});linked.length&&(values=linked.map(function(t){return this.id.replace("js-cb-","")+"="+$(this).data("value")}).get(),url+="?"+values.join("&"))}$.ajax({url:url,type:t.attr("data-method")||"GET",dataType:"json",success:function(data){t.attr("data-replace")?$.each(sel.split("|"),function(t,a){(inner=a.endsWith("<"))&&(a=a.replace("<","")),html=data.html.split("|")[t],res=$(a),res.each(function(t,a){$(this)[inner?"html":"replaceWith"](html)})}):result.html(data.html),t.attr("data-callback")&&(f=function(){eval(t.attr("data-callback"))},f.apply(t[0]))}}),e.preventDefault()}),$("body").on("submit",".js-ajax-form",function(){var t=$(this),result=t.attr("data-result");return $.ajax({url:t.attr("data-action"),type:t.attr("data-method")||"GET",data:t.serialize(),dataType:"json",success:function(data){$.each(result.split("|"),function(t,a){var e=a.indexOf("~")+1;$(a.replace("~",""))[e?"replaceWith":"html"](data.html.split("|")[t])}),t.attr("data-callback")&&(f=function(){eval(t.attr("data-callback"))},f.apply(t[0]))}}),!1}),$("body").on("click",".js-spin [data-spin]",function(){var t=$(this).parents(".js-spin").eq(0),a=t.data("min")||0,e=t.data("max")||9999,i=t.find(".js-spin-input"),n=parseInt(i.val()),r=t.data("min")||1;new_val="up"==$(this).data("spin")?Math.min(n+r,e):Math.max(n-r,a),i.val(new_val.toString()),t.is("form")&&t.trigger("submit")}),$("body").on("click",".js-remove",function(){$(this).parents("tr, .js-list-item").eq(0).remove()}),$(".js-combobox li a").click(function(t){var a=$(this).closest(".js-combobox"),e=$(this);a.find(".js-cb-title").text(e.text()),a.data("value",e.data("value")),t.preventDefault()}),$(".js-testimonial").click(function(){$(".comment-form").toggle()})});